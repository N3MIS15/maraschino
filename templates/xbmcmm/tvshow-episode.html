<div class="episode_details span10">
  {% if episode %}
    <div class="row-fluid top_buttons">
      <button class="btn tvdb_episode_info_btn" data-loading-text="Loading...">
        TVDB lookup
      </button>

      <button class="btn btn-danger pull-right remove_item">
        Remove episode
      </button>
  </div>

  <div class="span4">
    <form class="form-horizontal">
      <div id="media_id" media-type="episode" data-id="{{ episode.episodeid }}" data-tvshowid="{{ episode.tvshowid }}"></div>
      <fieldset>

        {% macro control_group(name, title) %}
          <div class="control-group">
            <label class="control-label" for="id_{{ name }}">{{ title }}</label>
            <div class="controls">
              {% if name == 'plot' %}
                <textarea type="text" id="id_{{ name }}" name="{{ name }}">{{ episode[name] }}</textarea>
              {% else %}
                <input id="id_{{ name }}" name="{{ name }}" type="text" value="{{ episode[name]|float|round(1, 'common') if name == 'rating' else episode[name] }}">
              {% endif %}
            </div>
          </div>
        {% endmacro %}

        {{ control_group('title', 'Title') }}
        {{ control_group('plot', 'Plot') }}
        {{ control_group('firstaired', 'First Aired') }}
        {{ control_group('rating', 'Rating') }}
        {{ control_group('votes', 'Votes') }}
        {{ control_group('director', 'Director') }}
        {{ control_group('writer', 'Writer') }}

        {% macro hidden_input(name, art=True) %}
          <input id="id_{{ name }}" name="{{ name }}" type="hidden" value="{{ episode['art'][name] if art else episode[name] }}">
        {% endmacro %}

        {{ hidden_input('episode', False) }}
        {{ hidden_input('season', False) }}
        {{ hidden_input('thumb') }}
        <button type="button" class="btn btn-success xbmc_save">Apply Changes</button>
      </fieldset>
    </form>
  </div>

  <div class="span4 thumbnail">
      {% if 'thumb' in episode.art %}
        <img id="thumb_img" src="{{ episode.art.thumb|xbmc_image }}" />
      {% else %}
        <div align="center">Artwork not available.</div>
      {% endif %}
    <br>
    <div class="pull-right">
      <button class="btn file_btn" data-type="episode_thumb">File</button>
      <button class="btn url_btn" data-type="episode_thumb">URL</button>
    </div>
  </div>

  {% endif %}
</div>